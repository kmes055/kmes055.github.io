---
title: "[스터디]인프라 엔지니어의 교과서"
categories:
  - study
tags:
  - 공부
  - Infra
---
# 4장: 네트워크
### 네트워크
* 서버 등 복수의 노드를 유선 또는 무선으로 연결한 집합체
### 네트워크 장비
* LAN, 광섬유 케이블 등을 집약해 통신을 교환하는 장치
* 라우터, L2, L3, L4, L7 스위치 등이 있음

## 네트워크 장비 선택
### 라우터
* 패킷을 적절한 경로로 전송하는 네트워크 장비
* 네트워크를 논리적으로 나누는 장비
* 내부에 라우팅 테이블을 가지고 있어서, 목적지에 따라 다음 라우터로 안내해 줌
    ### 라우팅 방식
    * Static: 경로 정보를 수동으로 등록. ISP와 데이터센터에 바로 연결된 대규모 네트워크에 용이
    * Dynamic: 경로를 dynamic하게 등록. RIP, OSPF, BGP 등이 있으며, longest prefix를 기준 weight로 삼은 그래프 최소 경로 알고리즘(dijkstra, bellman-ford) 등으로 구현됨
* 라우터의 선택 포인트
    1. 상위 회선의 인터페이스와 일치하는 WAN 인터페이스 가지기. 상위 회선이 1000BASE-T 인터페이스라면 라우터도 같은 인터페이스를 써야 함. 상위 회선 담당자에게 문의해 볼 필요는 있지만, 대개는 이용자의 요구에 맞춤
    2. WAN의 통신 대역. WAN측 통신 대역이 1Mbps에도 못 미친다면 고가의 장비를 구입할 이유는 없음
    3. Throughput. 단위 시간당 데이터 전송량. 네트워크나 라우터에 들어오는 트래픽이 많다면 Throughput이 높은 장비를 선택해야 함
    4. 보안 기능. 특정 IP 차단, 포트 필터링 등의 통신을 차단하는 등의 보안 기능이 내장된 라우터가 있는데, 대규모 네트워크일 경우엔 보안 쪽을 물리적으로 분리하는 걸 권장
    5. 도입 비용. 대개 라우터는 비쌀수록 성능이 좋음

### L2, L3 스위치
>### L2 스위치
    * 이른바 업무용 스위칭 허브
    * 프레임이 들어오면 MAC주소를 보고 적절한 포트로 스위칭
    * 내부에 ARP 테이블을 가지고 있고, 테이블에 없는 정보가 들어오면 FF:FF:FF:FF:FF:FF를 목적지로 바꾸는 방법으로 브로드캐스트함
    * ARP테이블도 라우팅 테이블처럼, static, dynamic 방법이 있음
>### L3 스위치
    * 이른바 라우터 기능이 추가된 L2 스위치
    * 목적지의 IP주소를 보고 적절한 포트로 라우팅
    * 라우팅 테이블에 없는 목적지가 들어오면 기본 게이트웨이로 연결
* 스위치 선택 요령
    1. 인터페이스의 속도와 포트 수. 우선적으로 필요한 인터페이스 속도/ 포트 수 확보
    2. 지능형/비지능형. 특정 포트만 WAN 인터페이스를 다르게 설정하거나 VLAN을 설정해야 할 때는 지능형을 사용하는 게 좋음. 반면 단순히 연결만 하는 경우에는 비지능형으로도 충분
    3. 스위칭 능력과 스위칭 용량
      
      * 스위칭 능력: 스위칭 속도를 나타내는 단위 PPS(Packet Per Second)가 주로 쓰임
      * 스위칭 용량: 단위 시간이나 동시에 스위칭할수 있는 양. BPS 등의 단위가 있음
      * 와이어 스피드: 스위치에 탑재된 각 포트에 이론상 최대 통신량이 발생하는 상태
      * 논블로킹: 와이어 스피드를 처리할 수 있는 능력. 와이어 스피드/논블로킹 스위치이며 용량이 적절하다면 업무용 스위치로서 안심할 수 있음
    4. 하드웨어 처리와 소프트웨어 처리. ASIC와 같은 전용 칩을 사용하는 처리가 아니라면 CPU를 사용하는 처리일텐데, 대규모 통신은 CPU 사용이 위험할 수 있음

### L4, L7 스위치
* 이른바 Load Balancer가 달린 L3 스위치. L4는 TCP/UDP 포트, L7은 URL을 보고 적절한 서버로 전송함
* 서버가 살았는지 감지할 수 있음. L4는 해당 IP + 포트 조합을 일적 간격으로 체크하고, L7은 특정 URL에 일정 간격으로 요청을 보내 예상한 응답이 오지 않으면 분산 대상에서 제외함
* L4/L7 스위치를 L2/L3 스위치와 같은 업체 제품으로 선택하면 명령 체계가 통일되므로 다루기 쉬워짐

## 네트워크 토폴로지
* 조건과 환경에 다라 무수한 네트워크 구조가 있지만, 자주 사용되는 몇 가지만 소개
### FE/BE 구조
#### FE
* 인터넷과 가까운 곳에 위치
* 서버별 IP 주소를 부여하거나, L4 스위치를 매개로 인터넷과 통신함
#### BE
* 인터넷과 먼 곳에 위치
* 상대적으로 외부 공격에 안전

### 3계층 구조
* Core, Distribution, Access layer로 구분
#### Core layer
* Distribution layer에서 오는 통신을 집약해 인터넷에 연결
* 네트워크 하나에 Core layer 한 세트가 일반적
#### Distribution layer
* 통신을 집약해 Core layer에 연결하고 Access layer와의 연결을 중계
* 사무실의 경우 한 층에 한 세트를 배치하는게 일반적
#### Access layer
* 서버에서 오는 통신을 Distribution layer에 연결.
* FE/BE 2계층 구조에서 본 웹 서버/DB는 일반적으로 이곳에 존재

### 네트워크 패브릭 구조
* 서버/스토리지에 이어, 네트워크도 가상화가 유행하기 시작함
* Access layer의 L2 네트워크를 가상화하여 물리적으로 다른 랙이나 스위치를 논리적으로 하나의 네트워크로 보이게 함
* 서버를 Access 계층의 어떤 스위치에나 연결할 수 있게 됨 -> 네트워크 구조에 따른 물리적인 제약 감소
* 표준화된 규격이 없고, 각 장비 업체에서 고유한 제품을 출시하는 상황

## 인터넷 연결
* ISP의 회선을 끌어오거나, 데이터 센터에서 제공하는 서비스를 이용해 코어 스위치와 데이터 센터의 스위치를 연결하는 방법이 있음
* 대규모일수록 전자가 유리함
* 요금 체계는 다양하나, 대개 고정대역 사용 무제한(특정 대역 내에서 무제한 사용), 종량과금(통신량에 따라 과금)으로 분류됨

## 네트워크 케이블
### LAN
* UTP, 트위스트 페어, 이더넷 등으로도 불림
* 다양한 규격이 새로 나오고 있음
* 규격에 따른 통신 품질의 차이가 적은 편
### 광파이버 케이블
* 기가바이트 네트워크에서 주로 사용
* 멀티 모드 파이버, 싱글 모드 파이버가 광섬유로 사용됨
* 멀티 모드는 전송 거리가 짧고 값이 싸지만, 싱글 모드는 전송 거리가 길고 가격이 비쌈
* 양 끝에 커넥터가 있는데, 다양한 종류가 있으나 SC/LC 커넥터가 주로 사용됨
* 빛/전기 신호를 변환하는 장비로 트랜시버가 사용됨
    